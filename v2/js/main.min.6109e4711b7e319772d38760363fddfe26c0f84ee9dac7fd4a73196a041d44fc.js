(()=>{var e,t,n,s,o=()=>{const e=document.getElementById("menu-toggle"),t=document.getElementById("mobile-menu");if(!e||!t)return;e.addEventListener("click",()=>{const n=e.getAttribute("aria-expanded")==="true";e.setAttribute("aria-expanded",!n),t.classList.toggle("is-active"),document.body.classList.toggle("menu-open")}),document.addEventListener("click",n=>{t.classList.contains("is-active")&&!t.contains(n.target)&&!e.contains(n.target)&&(e.setAttribute("aria-expanded","false"),t.classList.remove("is-active"),document.body.classList.remove("menu-open"))}),document.addEventListener("keydown",n=>{n.key==="Escape"&&t.classList.contains("is-active")&&(e.setAttribute("aria-expanded","false"),t.classList.remove("is-active"),document.body.classList.remove("menu-open"))})},i=()=>{const t=document.getElementById("search-toggle"),e=document.getElementById("search-modal"),n=document.getElementById("search-input"),s=document.getElementById("search-results");if(!t||!e||!n||!s)return;t.addEventListener("click",()=>{const s=t.getAttribute("aria-expanded")==="true";t.setAttribute("aria-expanded",!s),e.classList.toggle("is-active"),s?document.body.classList.remove("search-open"):(n.focus(),document.body.classList.add("search-open"))}),e.addEventListener("click",n=>{n.target===e&&(t.setAttribute("aria-expanded","false"),e.classList.remove("is-active"),document.body.classList.remove("search-open"))}),document.addEventListener("keydown",n=>{n.key==="Escape"&&e.classList.contains("is-active")&&(t.setAttribute("aria-expanded","false"),e.classList.remove("is-active"),document.body.classList.remove("search-open"))});let o;n.addEventListener("input",e=>{clearTimeout(o),o=setTimeout(()=>{const t=e.target.value.trim();if(t.length<2){s.innerHTML="";return}a(t)},300)})};async function a(e){const t=document.getElementById("search-results");t.innerHTML='<div class="search-loading">Searching...</div>';try{const s=await fetch(`/search.json`),o=await s.json(),n=o.filter(t=>{const n=`${t.title} ${t.content}`.toLowerCase();return n.includes(e.toLowerCase())});if(n.length===0){t.innerHTML='<div class="search-no-results">No results found</div>';return}const i=n.map(e=>`
      <article class="search-result">
        <h3><a href="${e.permalink}">${e.title}</a></h3>
        <div class="search-result-excerpt">${e.summary}</div>
      </article>
    `).join("");t.innerHTML=i}catch(e){console.error("Search error:",e),t.innerHTML='<div class="search-error">An error occurred while searching</div>'}}t=()=>{const e=document.getElementById("newsletter-form");if(!e)return;e.addEventListener("submit",async t=>{t.preventDefault();const o=e.querySelector('button[type="submit"]'),s=e.querySelector('input[type="email"]').value,n=e.querySelector(".newsletter-status");if(!n)return;if(!s||!s.includes("@")){n.innerHTML="Please enter a valid email address",n.classList.add("error");return}try{o.disabled=!0,n.innerHTML="Subscribing...",n.classList.remove("error","success");const t=await fetch("/api/subscribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s})}),i=await t.json();if(t.ok)n.innerHTML="Thank you for subscribing!",n.classList.add("success"),e.reset();else throw new Error(i.message||"Subscription failed")}catch(e){n.innerHTML=e.message||"An error occurred. Please try again.",n.classList.add("error")}finally{o.disabled=!1}})},n=class{constructor(e,t,n,s,o,i,a){this.width=e.width,this.height=e.height,this.ctx=t,this.x=n,this.y=s,this.color=o,this.speed=this.getRandomValue(.1,.9)*i,this.size=0,this.sizeStep=Math.random()*.4,this.minSize=.5,this.maxSizeInteger=2,this.maxSize=this.getRandomValue(this.minSize,this.maxSizeInteger),this.delay=a,this.counter=0,this.counterStep=Math.random()*4+(this.width+this.height)*.01,this.isIdle=!1,this.isReverse=!1,this.isShimmer=!1}getRandomValue(e,t){return Math.random()*(t-e)+e}draw(){const e=this.maxSizeInteger*.5-this.size*.5;this.ctx.fillStyle=this.color,this.ctx.fillRect(this.x+e,this.y+e,this.size,this.size)}appear(){if(this.isIdle=!1,this.counter<=this.delay){this.counter+=this.counterStep;return}this.size>=this.maxSize&&(this.isShimmer=!0),this.isShimmer?this.shimmer():this.size+=this.sizeStep,this.draw()}disappear(){if(this.isShimmer=!1,this.counter=0,this.size<=0){this.isIdle=!0;return}this.size-=.1,this.draw()}shimmer(){this.size>=this.maxSize?this.isReverse=!0:this.size<=this.minSize&&(this.isReverse=!1),this.isReverse?this.size-=this.speed:this.size+=this.speed}},s=class extends HTMLElement{static register(e="pixel-hover"){"customElements"in window&&customElements.define(e,this)}get colors(){return this.dataset.colors?.split(",")||["#f8fafc","#f1f5f9","#cbd5e1"]}get gap(){const e=this.dataset.gap||5,t=4,n=50;return Math.min(Math.max(parseInt(e),t),n)}get speed(){const e=this.dataset.speed||35,t=0,n=100,s=.001;return this.reducedMotion?0:Math.min(Math.max(parseInt(e),t),n)*s}connectedCallback(){const e=document.createElement("canvas");this.canvas=e,this.ctx=e.getContext("2d"),this.timeInterval=1e3/60,this.timePrevious=performance.now(),this.reducedMotion=window.matchMedia("(prefers-reduced-motion: reduce)").matches,this.appendChild(e),this.init(),this.resizeObserver=new ResizeObserver(()=>this.init()),this.resizeObserver.observe(this),this.parentElement.addEventListener("mouseenter",()=>this.handleAnimation("appear")),this.parentElement.addEventListener("mouseleave",()=>this.handleAnimation("disappear")),this.parentElement.addEventListener("focusin",e=>{if(e.currentTarget.contains(e.relatedTarget))return;this.handleAnimation("appear")}),this.parentElement.addEventListener("focusout",e=>{if(e.currentTarget.contains(e.relatedTarget))return;this.handleAnimation("disappear")})}disconnectedCallback(){this.resizeObserver.disconnect()}handleAnimation(e){cancelAnimationFrame(this.animation),this.animation=this.animate(e)}init(){const e=this.getBoundingClientRect(),t=Math.floor(e.width),n=Math.floor(e.height);this.pixels=[],this.canvas.width=t,this.canvas.height=n,this.canvas.style.width=`${t}px`,this.canvas.style.height=`${n}px`,this.createPixels()}getDistanceToCanvasCenter(e,t){const n=e-this.canvas.width/2,s=t-this.canvas.height/2;return Math.sqrt(n*n+s*s)}createPixels(){for(let e=0;e<this.canvas.width;e+=this.gap)for(let t=0;t<this.canvas.height;t+=this.gap){const s=this.colors[Math.floor(Math.random()*this.colors.length)],o=this.reducedMotion?0:this.getDistanceToCanvasCenter(e,t);this.pixels.push(new n(this.canvas,this.ctx,e,t,s,this.speed,o))}}animate(e){this.animation=requestAnimationFrame(()=>this.animate(e));const t=performance.now(),n=t-this.timePrevious;if(n<this.timeInterval)return;this.timePrevious=t-n%this.timeInterval,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);for(const t of this.pixels)t[e]();this.pixels.every(e=>e.isIdle)&&cancelAnimationFrame(this.animation)}},s.register(),e={features:{search:document.body.dataset.search==="true",newsletter:document.body.dataset.newsletter==="true"}},document.addEventListener("DOMContentLoaded",()=>{o(),e.features.search&&i(),e.features.newsletter&&t();const s=document.querySelectorAll("[data-animate]"),n=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(e.target.classList.add("animated"),n.unobserve(e.target))})},{threshold:.1});s.forEach(e=>n.observe(e))})})()