(()=>{var e,t,n=()=>{const e=document.getElementById("menu-toggle"),t=document.getElementById("mobile-menu");if(!e||!t)return;e.addEventListener("click",()=>{const n=e.getAttribute("aria-expanded")==="true";e.setAttribute("aria-expanded",!n),t.classList.toggle("is-active"),document.body.classList.toggle("menu-open")}),document.addEventListener("click",n=>{t.classList.contains("is-active")&&!t.contains(n.target)&&!e.contains(n.target)&&(e.setAttribute("aria-expanded","false"),t.classList.remove("is-active"),document.body.classList.remove("menu-open"))}),document.addEventListener("keydown",n=>{n.key==="Escape"&&t.classList.contains("is-active")&&(e.setAttribute("aria-expanded","false"),t.classList.remove("is-active"),document.body.classList.remove("menu-open"))})},s=()=>{const t=document.getElementById("search-toggle"),e=document.getElementById("search-modal"),n=document.getElementById("search-input"),s=document.getElementById("search-results");if(!t||!e||!n||!s)return;t.addEventListener("click",()=>{const s=t.getAttribute("aria-expanded")==="true";t.setAttribute("aria-expanded",!s),e.classList.toggle("is-active"),s?document.body.classList.remove("search-open"):(n.focus(),document.body.classList.add("search-open"))}),e.addEventListener("click",n=>{n.target===e&&(t.setAttribute("aria-expanded","false"),e.classList.remove("is-active"),document.body.classList.remove("search-open"))}),document.addEventListener("keydown",n=>{n.key==="Escape"&&e.classList.contains("is-active")&&(t.setAttribute("aria-expanded","false"),e.classList.remove("is-active"),document.body.classList.remove("search-open"))});let i;n.addEventListener("input",e=>{clearTimeout(i),i=setTimeout(()=>{const t=e.target.value.trim();if(t.length<2){s.innerHTML="";return}o(t)},300)})};async function o(e){const t=document.getElementById("search-results");t.innerHTML='<div class="search-loading">Searching...</div>';try{const s=await fetch(`/search.json`),o=await s.json(),n=o.filter(t=>{const n=`${t.title} ${t.content}`.toLowerCase();return n.includes(e.toLowerCase())});if(n.length===0){t.innerHTML='<div class="search-no-results">No results found</div>';return}const i=n.map(e=>`
      <article class="search-result">
        <h3><a href="${e.permalink}">${e.title}</a></h3>
        <div class="search-result-excerpt">${e.summary}</div>
      </article>
    `).join("");t.innerHTML=i}catch(e){console.error("Search error:",e),t.innerHTML='<div class="search-error">An error occurred while searching</div>'}}t=()=>{const e=document.getElementById("newsletter-form");if(!e)return;e.addEventListener("submit",async t=>{t.preventDefault();const o=e.querySelector('button[type="submit"]'),s=e.querySelector('input[type="email"]').value,n=e.querySelector(".newsletter-status");if(!n)return;if(!s||!s.includes("@")){n.innerHTML="Please enter a valid email address",n.classList.add("error");return}try{o.disabled=!0,n.innerHTML="Subscribing...",n.classList.remove("error","success");const t=await fetch("/api/subscribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s})}),i=await t.json();if(t.ok)n.innerHTML="Thank you for subscribing!",n.classList.add("success"),e.reset();else throw new Error(i.message||"Subscription failed")}catch(e){n.innerHTML=e.message||"An error occurred. Please try again.",n.classList.add("error")}finally{o.disabled=!1}})},e={features:{search:document.body.dataset.search==="true",newsletter:document.body.dataset.newsletter==="true"}},document.addEventListener("DOMContentLoaded",()=>{n(),e.features.search&&s(),e.features.newsletter&&t();const i=document.querySelectorAll("[data-animate]"),o=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(e.target.classList.add("animated"),o.unobserve(e.target))})},{threshold:.1});i.forEach(e=>o.observe(e))})})()